var h=(d,o,a)=>new Promise((t,u)=>{var i=c=>{try{f(a.next(c))}catch(e){u(e)}},p=c=>{try{f(a.throw(c))}catch(e){u(e)}},f=c=>c.done?t(c.value):Promise.resolve(c.value).then(i,p);f((a=a.apply(d,o)).next())});import{d as b,q as _,r as j,p as k,w as S,o as l,c as r,F as C,i as D,a as v,t as y,l as g,_ as E}from"./index-BaVYsHIV.js";const U={key:0,class:"avatar-group -space-x-6 rtl:space-x-reverse"},N=["src","alt"],A={key:1,class:"placeholder rounded-full bg-gray-200 w-full h-full flex items-center justify-center text-gray-600 p-2"},O=["src","alt"],z={key:1,class:"placeholder rounded-full bg-gray-200 w-full h-full flex items-center justify-center text-gray-600 p-2"},w=2*24*60*60*1e3,B=b({__name:"UserAvatar",props:{email:{},size:{}},setup(d){const o=d,a=_(()=>o.email?o.email.split(",").map(e=>e.trim()).filter(Boolean):[]),t=j([]),u=e=>e.split("@")[0].slice(0,2).toUpperCase(),i=_(()=>{switch(o.size){case"sm":return"w-8 h-8";case"lg":return"w-12 h-12";default:return"w-10 h-10"}}),p=k({url:"smartoffice.api.util.get_avartar",auto:!1}),f=()=>h(this,null,function*(){if(t.value=[],!!a.value.length)for(const e of a.value){if(!e){t.value.push("");continue}try{const s=localStorage.getItem(`avatar_${e}`);if(s){const{image:x,timestamp:I}=JSON.parse(s);if(Date.now()-I<w){t.value.push(x);continue}}const n=(yield p.submit({doctype:"User",name:e})).user_image||"";t.value.push(n),localStorage.setItem(`avatar_${e}`,JSON.stringify({image:n,timestamp:Date.now()}))}catch(s){console.error("Error fetching user image:",s),t.value.push("")}}});return(()=>{Object.keys(localStorage).forEach(e=>{if(e.startsWith("avatar_")){const s=localStorage.getItem(e);if(s){const{timestamp:m}=JSON.parse(s);Date.now()-m>=w&&localStorage.removeItem(e)}}})})(),S(()=>o.email,f,{immediate:!0}),(e,s)=>a.value.length>1?(l(),r("div",U,[(l(!0),r(C,null,D(a.value,(m,n)=>(l(),r("div",{key:n,class:"avatar"},[v("div",{class:g([i.value,"flex items-center justify-center overflow-hidden"])},[t.value[n]?(l(),r("img",{key:0,src:t.value[n],alt:m,class:"rounded-full w-full h-full object-cover"},null,8,N)):(l(),r("div",A,[v("span",null,y(u(m)),1)]))],2)]))),128))])):a.value.length===1?(l(),r("div",{key:1,class:g([i.value,"avatar flex items-center justify-center overflow-hidden"])},[t.value[0]?(l(),r("img",{key:0,src:t.value[0],alt:a.value[0],class:"rounded-full w-full h-full object-cover"},null,8,O)):(l(),r("div",z,[v("span",null,y(u(a.value[0])),1)]))],2)):(l(),r("div",{key:2,class:g([i.value,"avatar flex items-center justify-center overflow-hidden"])},s[0]||(s[0]=[v("div",{class:"placeholder rounded-full bg-gray-200 w-full h-full flex items-center justify-center text-gray-600 p-2"},[v("span",null,"N/A")],-1)]),2))}}),F=E(B,[["__scopeId","data-v-3229ebeb"]]);export{F as U};
