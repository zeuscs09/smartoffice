import{m as V,p as j,d as z,u as U,q as B,r as u,A as y,g as $,B as L,C as M,o as h,a as t,v as l,s as c,l as i,t as n,c as F,D as p,K as C,G as w,b as N,i as Q,x as I,F as H,_ as q}from"./index-HzjLN9rv.js";import{U as E}from"./userLayout-CoZYfH6Y.js";import{U as G}from"./UserAvatar-DEtzeBnv.js";const J=V("smoTask",{state:()=>({currentPage:1,pageSize:10,totalPages:1,documentsResource:j({url:"smartoffice.api.task.get_todos_with_smo_tasks",auto:!1}),searchQuery:"",statusFilter:"",startDate:"",endDate:"",sortField:"",sortOrder:"asc"}),actions:{fetchAll(o){var r;return this.currentPage=o,this.documentsResource.fetch({page:this.currentPage,page_size:this.pageSize,search:this.searchQuery,status:this.statusFilter,start_date:this.startDate,end_date:this.endDate,sort_field:this.sortField,sort_order:this.sortOrder}),this.totalPages=((r=this.documentsResource.data)==null?void 0:r.total_pages)||1,this.documentsResource},setSearchQuery(o){this.searchQuery=o,this.fetchAll(1)},setStatusFilter(o){this.statusFilter=o,this.fetchAll(1)},setDateRange(o,r){this.startDate=o,this.endDate=r,this.fetchAll(1)},setSorting(o){this.sortField===o?this.sortOrder=this.sortOrder==="asc"?"desc":"asc":(this.sortField=o,this.sortOrder="asc"),this.fetchAll(this.currentPage)},nextPage(){this.currentPage<this.totalPages&&this.fetchAll(this.currentPage+1)},previousPage(){this.currentPage>1&&this.fetchAll(this.currentPage-1)},goToPage(o){o>=1&&o<=this.totalPages&&this.fetchAll(o)},get(o){return this.data.find(r=>r.id===o)}},getters:{data(){var o;return((o=this.documentsResource.data)==null?void 0:o.data)||[]},isFirstPage(){return this.currentPage===1},isLastPage(){return this.currentPage===this.totalPages}}}),K={class:"container mx-auto p-4"},W={class:"flex justify-between items-center mb-4"},X={class:"breadcrumbs text-sm"},Y={class:"flex gap-2"},Z={key:0,class:"flex flex-wrap gap-4 mb-4"},tt={class:"overflow-x-auto mt-4"},et={class:"table table-zebra w-full"},st={class:"ml-1"},at={class:"ml-1"},lt={class:"ml-1"},ot=["onClick"],nt=["onClick"],rt={class:"badge badge-sm badge-ghost"},it={class:"flex justify-between items-center mt-4"},dt={class:"join"},ut=["disabled"],ct={class:"join-item btn"},mt=["disabled"],pt={class:"text-sm text-gray-600 mt-2"},ht=z({__name:"TaskList",setup(o){const r=U(),s=J(),P=B("formatDate"),g=u(""),v=u(""),f=u(""),b=u(""),k=u(10),m=u(!1),D=y(()=>s.data.length),A=y(()=>{var d;return((d=s.documentsResource.data)==null?void 0:d.total)||0});$(()=>{s.fetchAll(1)});const O=()=>{m.value=!m.value},S=()=>{s.searchQuery=g.value,s.fetchAll(1)},x=()=>{s.statusFilter=v.value,s.startDate=f.value,s.endDate=b.value,s.fetchAll(1)},_=d=>{s.sortField===d?s.sortOrder=s.sortOrder==="asc"?"desc":"asc":(s.sortField=d,s.sortOrder="asc"),s.fetchAll(1)},R=()=>{s.pageSize=k.value,s.fetchAll(1)};return(d,e)=>(h(),L(E,null,{default:M(()=>[t("div",K,[t("div",W,[t("div",X,[t("ul",null,[t("li",null,[t("a",{onClick:e[0]||(e[0]=a=>l(r).push("/"))},"Home")]),e[11]||(e[11]=t("li",null,"My Task",-1))])]),t("div",Y,[e[13]||(e[13]=t("button",{class:"btn btn-primary btn-sm"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),c(" เพิ่ม ")],-1)),t("button",{class:i(["btn btn-sm",{"btn-ghost":!m.value}]),onClick:O},[e[12]||(e[12]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)),c(" "+n(m.value?"ซ่อนตัวกรอง":"ตัวกรอง"),1)],2)])]),m.value?(h(),F("div",Z,[p(t("input",{type:"text",placeholder:"No.,Task,Customer,Responsible",class:"input input-bordered input-sm flex-grow","onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),onInput:S},null,544),[[C,g.value]]),p(t("select",{class:"select select-bordered select-sm w-full max-w-xs","onUpdate:modelValue":e[2]||(e[2]=a=>v.value=a),onChange:x},e[14]||(e[14]=[t("option",{value:""},"ทุกสถานะ",-1),t("option",{value:"Open"},"เปิด",-1),t("option",{value:"Closed"},"ปิด",-1),t("option",{value:"Cancelled"},"ยกเลิก",-1)]),544),[[w,v.value]]),p(t("input",{type:"date",class:"input input-bordered input-sm","onUpdate:modelValue":e[3]||(e[3]=a=>f.value=a),onChange:x},null,544),[[C,f.value]]),p(t("input",{type:"date",class:"input input-bordered input-sm","onUpdate:modelValue":e[4]||(e[4]=a=>b.value=a),onChange:x},null,544),[[C,b.value]])])):N("",!0),t("div",tt,[t("table",et,[t("thead",null,[t("tr",null,[t("th",{class:"cursor-pointer",onClick:e[5]||(e[5]=a=>_("reference_name"))},[e[15]||(e[15]=c(" No. ")),t("span",st,[t("span",{class:i({"text-primary":l(s).sortField==="reference_name"})},n(l(s).sortField==="reference_name"&&l(s).sortOrder==="asc"?"▲":"△"),3),t("span",{class:i({"text-primary":l(s).sortField==="reference_name"})},n(l(s).sortField==="reference_name"&&l(s).sortOrder==="desc"?"▼":"▽"),3)])]),t("th",{class:"cursor-pointer",onClick:e[6]||(e[6]=a=>_("status"))},[e[16]||(e[16]=c(" Task ")),t("span",at,[t("span",{class:i({"text-primary":l(s).sortField==="status"})},n(l(s).sortField==="status"&&l(s).sortOrder==="asc"?"▲":"△"),3),t("span",{class:i({"text-primary":l(s).sortField==="status"})},n(l(s).sortField==="status"&&l(s).sortOrder==="desc"?"▼":"▽"),3)])]),t("th",{class:"cursor-pointer",onClick:e[7]||(e[7]=a=>_("due_date"))},[e[17]||(e[17]=c(" Job Date ")),t("span",lt,[t("span",{class:i({"text-primary":l(s).sortField==="due_date"})},n(l(s).sortField==="due_date"&&l(s).sortOrder==="asc"?"▲":"△"),3),t("span",{class:i({"text-primary":l(s).sortField==="due_date"})},n(l(s).sortField==="due_date"&&l(s).sortOrder==="desc"?"▼":"▽"),3)])]),e[18]||(e[18]=t("th",null,"Customer",-1)),e[19]||(e[19]=t("th",null,"Responsible",-1))])]),t("tbody",null,[(h(!0),F(H,null,Q(l(s).data,a=>(h(),F("tr",{key:a.name},[t("td",null,[t("span",{class:"cursor-pointer",onClick:T=>l(r).push({name:"TaskDetail",params:{id:a.reference_name}})},n(a.reference_name),9,ot)]),t("td",null,[t("span",{class:"cursor-pointer",onClick:T=>l(r).push({name:"TaskDetail",params:{id:a.reference_name}})},n(a.description),9,nt),e[20]||(e[20]=t("br",null,null,-1)),t("span",{class:i(["badge badge-sm",{"badge-primary":a.status==="Open","badge-success":a.status==="Closed","badge-error":a.status==="Cancelled"}])},n(a.status),3)]),t("td",null,n(l(P)(a.due_date)),1),t("td",null,[c(n(a.contact_person)+" - "+n(a.contact_email)+" ",1),e[21]||(e[21]=t("br",null,null,-1)),t("span",rt,n(a.project),1)]),t("td",null,[I(G,{email:a.assign_to},null,8,["email"])])]))),128))])])]),t("div",it,[t("div",dt,[t("button",{class:"join-item btn",onClick:e[8]||(e[8]=a=>l(s).previousPage()),disabled:l(s).isFirstPage}," « ",8,ut),t("button",ct," หน้า "+n(l(s).currentPage),1),t("button",{class:"join-item btn",onClick:e[9]||(e[9]=a=>l(s).nextPage()),disabled:l(s).isLastPage}," » ",8,mt)]),p(t("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>k.value=a),onChange:R,class:"select select-bordered"},e[22]||(e[22]=[t("option",{value:10},"10 รายการ/หน้า",-1),t("option",{value:20},"20 รายการ/หน้า",-1),t("option",{value:50},"50 รายการ/หน้า",-1)]),544),[[w,k.value]])]),t("div",pt," แสดง "+n(D.value)+" จาก "+n(A.value)+" รายการ ",1)])]),_:1}))}}),bt=q(ht,[["__scopeId","data-v-17b6560c"]]);export{bt as default};
