import{d as U,u as $,q as B,r as i,A as y,g as z,B as L,C as N,o as p,a as t,v as l,l as r,s as u,t as a,c as _,D as m,K as C,G as F,b as P,i as T,x as I,F as M,_ as Q}from"./index-HzjLN9rv.js";import{U as q}from"./userLayout-CoZYfH6Y.js";import{u as E}from"./serviceReportStore-CwMoOWHa.js";import{U as G}from"./UserAvatar-DEtzeBnv.js";const H={class:"container mx-auto p-4"},J={class:"flex justify-between items-center mb-4"},K={class:"breadcrumbs text-sm"},W={key:0,class:"flex flex-wrap gap-4 mb-4"},X={class:"overflow-x-auto mt-4"},Y={class:"table table-zebra w-full"},Z={class:"ml-1"},tt={class:"ml-1"},et={class:"ml-1"},st=["onClick"],ot=["onClick"],lt={class:"badge badge-sm badge-ghost"},at={class:"flex justify-between items-center mt-4"},nt={class:"join"},rt=["disabled"],it={class:"join-item btn"},dt=["disabled"],ut={class:"text-sm text-gray-600 mt-2"},mt=U({__name:"ServiceReportList",setup(pt){const x=$(),s=E(),j=B("formatDate"),c=i(""),v=i(""),b=i(""),f=i(""),w=i(10),d=i(!1),S=y(()=>s.data.length),h=y(()=>{var n;return((n=s.documentsResource.data)==null?void 0:n.total)||0});z(()=>{s.fetchAll(1)});const A=()=>{d.value=!d.value},D=()=>{s.searchQuery=c.value,s.fetchAll(1)},g=()=>{s.statusFilter=v.value,s.startDate=b.value,s.endDate=f.value,s.fetchAll(1)},k=n=>{s.sortField===n?s.sortOrder=s.sortOrder==="asc"?"desc":"asc":(s.sortField=n,s.sortOrder="asc"),s.fetchAll(1)},R=()=>{s.pageSize=w.value,s.fetchAll(1)},V=n=>{location.href=`/app/smo-service-report/${n}?from_page=service_report`};return(n,e)=>(p(),L(q,null,{default:N(()=>[t("div",H,[t("div",J,[t("div",K,[t("ul",null,[t("li",null,[t("a",{onClick:e[0]||(e[0]=o=>l(x).push("/"))},"Home")]),e[11]||(e[11]=t("li",null,"Service Report",-1))])]),t("button",{class:r(["btn btn-sm",{"btn-ghost":!d.value}]),onClick:A},[e[12]||(e[12]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)),u(" "+a(d.value?"ซ่อนตัวกรอง":"ตัวกรอง"),1)],2)]),d.value?(p(),_("div",W,[m(t("input",{type:"text",placeholder:"No.,Task,Customer,Responsible",class:"input input-bordered input-sm flex-grow","onUpdate:modelValue":e[1]||(e[1]=o=>c.value=o),onInput:D},null,544),[[C,c.value]]),m(t("select",{class:"select select-bordered select-sm w-full max-w-xs","onUpdate:modelValue":e[2]||(e[2]=o=>v.value=o),onChange:g},e[13]||(e[13]=[t("option",{value:"",disabled:"",selected:""},"All Status",-1),t("option",{value:"Customer Review"},"Customer Review",-1),t("option",{value:"Customer Approve"},"Customer Approve",-1)]),544),[[F,v.value]]),m(t("input",{type:"date",class:"input input-bordered input-sm","onUpdate:modelValue":e[3]||(e[3]=o=>b.value=o),onChange:g},null,544),[[C,b.value]]),m(t("input",{type:"date",class:"input input-bordered input-sm","onUpdate:modelValue":e[4]||(e[4]=o=>f.value=o),onChange:g},null,544),[[C,f.value]])])):P("",!0),t("div",X,[t("table",Y,[t("thead",null,[t("tr",null,[t("th",{class:"cursor-pointer",onClick:e[5]||(e[5]=o=>k("name"))},[e[14]||(e[14]=u(" No. ")),t("span",Z,[t("span",{class:r({"text-primary":l(s).sortField==="name"})},a(l(s).sortField==="name"&&l(s).sortOrder==="asc"?"▲":"△"),3),t("span",{class:r({"text-primary":l(s).sortField==="name"})},a(l(s).sortField==="name"&&l(s).sortOrder==="desc"?"▼":"▽"),3)])]),t("th",{class:"cursor-pointer",onClick:e[6]||(e[6]=o=>k("workflow_state"))},[e[15]||(e[15]=u(" Task ")),t("span",tt,[t("span",{class:r({"text-primary":l(s).sortField==="workflow_state"})},a(l(s).sortField==="workflow_state"&&l(s).sortOrder==="asc"?"▲":"△"),3),t("span",{class:r({"text-primary":l(s).sortField==="workflow_state"})},a(l(s).sortField==="workflow_state"&&l(s).sortOrder==="desc"?"▼":"▽"),3)])]),t("th",{class:"cursor-pointer",onClick:e[7]||(e[7]=o=>k("job_start_on"))},[e[16]||(e[16]=u(" Job Date ")),t("span",et,[t("span",{class:r({"text-primary":l(s).sortField==="job_start_on"})},a(l(s).sortField==="job_start_on"&&l(s).sortOrder==="asc"?"▲":"△"),3),t("span",{class:r({"text-primary":l(s).sortField==="job_start_on"})},a(l(s).sortField==="job_start_on"&&l(s).sortOrder==="desc"?"▼":"▽"),3)])]),e[17]||(e[17]=t("th",null,"Customer",-1)),e[18]||(e[18]=t("th",null,"Responsible",-1))])]),t("tbody",null,[(p(!0),_(M,null,T(l(s).data,o=>(p(),_("tr",{key:o.name},[t("td",null,[t("span",{class:"cursor-pointer",onClick:O=>V(o.name)},a(o.name),9,st)]),t("td",null,[t("span",{class:"cursor-pointer",onClick:O=>l(x).push({name:"TaskDetail",params:{id:o.task}})},a(o.task_name),9,ot),e[19]||(e[19]=t("br",null,null,-1)),t("span",{class:r(["badge badge-sm",{"badge-primary":o.workflow_state==="Customer Review","badge-success":o.workflow_state==="Customer Approve"}])},a(o.workflow_state),3)]),t("td",null,a(l(j)(o.job_start_on)),1),t("td",null,[u(a(o.contact_name)+" - "+a(o.contact_email)+" ",1),e[20]||(e[20]=t("br",null,null,-1)),t("span",lt,a(o.customer_name),1)]),t("td",null,[I(G,{email:o.teams},null,8,["email"])])]))),128))])])]),t("div",at,[t("div",nt,[t("button",{class:"join-item btn",onClick:e[8]||(e[8]=o=>l(s).previousPage()),disabled:l(s).isFirstPage}," « ",8,rt),t("button",it," หน้า "+a(l(s).currentPage),1),t("button",{class:"join-item btn",onClick:e[9]||(e[9]=o=>l(s).nextPage()),disabled:l(s).isLastPage}," » ",8,dt)]),m(t("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>w.value=o),onChange:R,class:"select select-bordered"},e[21]||(e[21]=[t("option",{value:10},"10 รายการ/หน้า",-1),t("option",{value:20},"20 รายการ/หน้า",-1),t("option",{value:50},"50 รายการ/หน้า",-1)]),544),[[F,w.value]])]),t("div",ut," แสดง "+a(S.value)+" จาก "+a(h.value)+" รายการ ",1)])]),_:1}))}}),wt=Q(mt,[["__scopeId","data-v-0b7a691c"]]);export{wt as default};
