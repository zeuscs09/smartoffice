import{J as S,p as _,d as P,m as D,u as x,q as C,o as a,c as o,a as e,I as c,l as d,t as l,b as f,y as u,F as k,i as v,B as F,_ as O}from"./index-BjUjyLbN.js";import{U as w}from"./UserAvatar--QHl542-.js";import{S as R,N as j}from"./NoDataFoundTable-CQstSkm9.js";import{S as A,N}from"./NoDataFoundCard-Dr_8P_bw.js";const ot=S("serviceReport",{state:()=>({currentPage:1,pageSize:10,documentsResource:_({url:"smartoffice.api.servicereport.get_user_service_reports",auto:!1}),searchQuery:"",statusFilter:"",startDate:"",endDate:"",sortField:"",sortOrder:"asc"}),actions:{fetchAll(t){return this.currentPage=t,this.documentsResource.fetch({page:this.currentPage,page_size:this.pageSize,search:this.searchQuery,status:this.statusFilter,start_date:this.startDate,end_date:this.endDate,sort_field:this.sortField,sort_order:this.sortOrder}),this.documentsResource},setSearchQuery(t){this.searchQuery=t,this.fetchAll(1)},setStatusFilter(t){this.statusFilter=t,this.fetchAll(1)},setDateRange(t,h){this.startDate=t,this.endDate=h,this.fetchAll(1)},setSorting(t){this.sortField===t?this.sortOrder=this.sortOrder==="asc"?"desc":"asc":(this.sortField=t,this.sortOrder="asc"),this.fetchAll(this.currentPage)},nextPage(){this.currentPage<this.totalPages&&this.fetchAll(this.currentPage+1)},previousPage(){this.currentPage>1&&this.fetchAll(this.currentPage-1)},goToPage(t){t>=1&&t<=this.totalPages&&this.fetchAll(t)},get(t){return this.data.find(h=>h.id===t)}},getters:{data(){var t;return((t=this.documentsResource.data)==null?void 0:t.data)||[]},isFirstPage(){return this.currentPage===1},isLastPage(){return this.currentPage===this.totalPages},totalPages(){var t;return((t=this.documentsResource.data)==null?void 0:t.total_pages)||1}}}),$={class:"hidden md:block"},B={class:"table table-zebra w-full"},T={key:0,class:"ml-1"},z={key:0,class:"ml-1"},Q={key:0,class:"ml-1"},V={key:0},L={colspan:"4"},q={key:1},I=["onClick"],U={class:"text-xs text-gray-500"},E={key:2},J={colspan:"4"},G={class:"md:hidden"},H={key:0},K={key:1,class:"space-y-4"},M={class:"card-body"},W=["onClick"],X={class:"text-sm text-gray-500"},Y={class:"card-actions justify-end"},Z={key:2},tt=P({__name:"ServiceReportTable",props:{data:{type:Array,required:!0},loading:{type:Boolean,default:!1},error:{type:Boolean,default:!1},sortField:{type:String,default:""},sortOrder:{type:String,default:"asc"},sortable:{type:Boolean,default:!0}},emits:["sort"],setup(t,{emit:h}){const i=t,g=D("formatDate");x();const y=n=>{switch(n.toLowerCase()){case"customer review":return"badge badge-warning";case"customer approve":return"badge badge-success";case"rejected":return"badge badge-error";default:return"badge"}},m=C(()=>!i.sortable||!i.sortField?i.data:[...i.data].sort((n,s)=>n[i.sortField]<s[i.sortField]?i.sortOrder==="asc"?-1:1:n[i.sortField]>s[i.sortField]?i.sortOrder==="asc"?1:-1:0)),b=n=>{location.href=`/app/smo-service-report/${n}`};return(n,s)=>(a(),o("div",null,[e("div",$,[e("table",B,[e("thead",null,[e("tr",null,[e("th",{class:"cursor-pointer",onClick:s[0]||(s[0]=r=>n.$emit("sort","name"))},[s[3]||(s[3]=c(" No. ")),t.sortable?(a(),o("span",T,[e("span",{class:d({"text-primary":t.sortField==="name"})},l(t.sortField==="name"&&t.sortOrder==="asc"?"▲":"△"),3),e("span",{class:d({"text-primary":t.sortField==="name"})},l(t.sortField==="name"&&t.sortOrder==="desc"?"▼":"▽"),3)])):f("",!0)]),e("th",{class:"cursor-pointer",onClick:s[1]||(s[1]=r=>n.$emit("sort","job_start_on"))},[s[4]||(s[4]=c(" Date ")),t.sortable?(a(),o("span",z,[e("span",{class:d({"text-primary":t.sortField==="job_start_on"})},l(t.sortField==="job_start_on"&&t.sortOrder==="asc"?"▲":"△"),3),e("span",{class:d({"text-primary":t.sortField==="job_start_on"})},l(t.sortField==="job_start_on"&&t.sortOrder==="desc"?"▼":"▽"),3)])):f("",!0)]),e("th",{class:"cursor-pointer",onClick:s[2]||(s[2]=r=>n.$emit("sort","workflow_state"))},[s[5]||(s[5]=c(" Status ")),t.sortable?(a(),o("span",Q,[e("span",{class:d({"text-primary":t.sortField==="workflow_state"})},l(t.sortField==="workflow_state"&&t.sortOrder==="asc"?"▲":"△"),3),e("span",{class:d({"text-primary":t.sortField==="workflow_state"})},l(t.sortField==="workflow_state"&&t.sortOrder==="desc"?"▼":"▽"),3)])):f("",!0)]),s[6]||(s[6]=e("th",null,"Responsible",-1))])]),t.loading?(a(),o("tbody",V,[e("tr",null,[e("td",L,[u(R)])])])):m.value.length>0?(a(),o("tbody",q,[(a(!0),o(k,null,v(m.value,r=>(a(),o("tr",{key:r.name},[e("td",null,[e("div",{class:"cursor-pointer",onClick:p=>b(r.name)},[c(l(r.name)+" ",1),s[7]||(s[7]=e("br",null,null,-1)),e("span",U,l(r.task_name),1)],8,I)]),e("td",null,l(F(g)(r.job_start_on)),1),e("td",null,[e("span",{class:d(y(r.workflow_state))},l(r.workflow_state),3)]),e("td",null,[u(w,{email:r.teams},null,8,["email"])])]))),128))])):(a(),o("tbody",E,[e("tr",null,[e("td",J,[u(j)])])]))])]),e("div",G,[t.loading?(a(),o("div",H,[u(A)])):m.value.length>0?(a(),o("div",K,[(a(!0),o(k,null,v(m.value,r=>(a(),o("div",{key:r.name,class:"card bg-base-100 shadow-xl"},[e("div",M,[e("h2",{class:"card-title cursor-pointer",onClick:p=>b(r.name)},l(r.name),9,W),e("p",X,l(r.task_name),1),e("p",null,"Date: "+l(F(g)(r.job_start_on)),1),e("p",null,[s[8]||(s[8]=c("Status: ")),e("span",{class:d(y(r.workflow_state))},l(r.workflow_state),3)]),e("div",Y,[u(w,{email:r.teams},null,8,["email"])])])]))),128))])):(a(),o("div",Z,[u(N)]))])]))}}),lt=O(tt,[["__scopeId","data-v-7d1a4d61"]]);export{lt as S,ot as u};
