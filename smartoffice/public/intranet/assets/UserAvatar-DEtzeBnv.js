var _=(d,n,a)=>new Promise((t,i)=>{var p=s=>{try{u(a.next(s))}catch(e){i(e)}},v=s=>{try{u(a.throw(s))}catch(e){i(e)}},u=s=>s.done?t(s.value):Promise.resolve(s.value).then(p,v);u((a=a.apply(d,n)).next())});import{d as S,A as f,r as k,p as C,w as D,o as c,c as l,F as E,i as U,a as g,t as h,l as y,_ as b}from"./index-HzjLN9rv.js";const A={key:0,class:"avatar-group -space-x-6 rtl:space-x-reverse"},N=["src","alt"],O={key:1,class:"placeholder rounded-full bg-gray-200 flex items-center justify-center text-gray-600"},z={class:"text-center"},B=["src","alt"],j={key:1,class:"placeholder rounded-full bg-gray-200 flex items-center justify-center text-gray-600"},J={class:"text-center"},x=2*24*60*60*1e3,R=S({__name:"UserAvatar",props:{email:{},size:{}},setup(d){const n=d,a=f(()=>n.email.split(",").map(e=>e.trim()).filter(Boolean)),t=k([]),i=e=>e.split("@")[0].slice(0,2).toUpperCase(),p=f(()=>{switch(n.size){case"sm":return"w-8 h-8";case"lg":return"w-12 h-12";default:return"w-10 h-10"}}),v=C({url:"smartoffice.api.util.get_avartar",auto:!1}),u=()=>_(this,null,function*(){t.value=[];for(const e of a.value)try{const r=localStorage.getItem(`avatar_${e}`);if(r){const{image:w,timestamp:I}=JSON.parse(r);if(Date.now()-I<x){t.value.push(w);continue}}const o=(yield v.submit({doctype:"User",name:e})).user_image||"";t.value.push(o),localStorage.setItem(`avatar_${e}`,JSON.stringify({image:o,timestamp:Date.now()}))}catch(r){console.error("Error fetching user image:",r),t.value.push("")}});return(()=>{Object.keys(localStorage).forEach(e=>{if(e.startsWith("avatar_")){const r=localStorage.getItem(e);if(r){const{timestamp:m}=JSON.parse(r);Date.now()-m>=x&&localStorage.removeItem(e)}}})})(),D(()=>n.email,u,{immediate:!0}),(e,r)=>a.value.length>1?(c(),l("div",A,[(c(!0),l(E,null,U(a.value,(m,o)=>(c(),l("div",{key:o,class:"avatar"},[g("div",{class:y(p.value)},[t.value[o]?(c(),l("img",{key:0,src:t.value[o],alt:m,class:"rounded-full"},null,8,N)):(c(),l("div",O,[g("span",z,h(i(m)),1)]))],2)]))),128))])):(c(),l("div",{key:1,class:y(["avatar",p.value])},[t.value[0]?(c(),l("img",{key:0,src:t.value[0],alt:a.value[0],class:"rounded-full"},null,8,B)):(c(),l("div",j,[g("span",J,h(i(a.value[0])),1)]))],2))}}),H=b(R,[["__scopeId","data-v-153bdbdc"]]);export{H as U};
