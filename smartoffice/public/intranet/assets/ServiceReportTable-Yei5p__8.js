import{J as x,p as S,d as P,m as C,u as D,q as O,o as a,c as o,a as e,I as c,l as d,t as n,b as g,y as u,F as p,i as F,B as w,_ as R}from"./index-BaVYsHIV.js";import{U as _}from"./UserAvatar-CeC7Avae.js";import{S as $,N as j}from"./NoDataFoundTable-CnqPHRye.js";import{S as A,N}from"./NoDataFoundCard-DVzi9gq9.js";const dt=x("serviceReport",{state:()=>({currentPage:1,pageSize:10,documentsResource:S({url:"smartoffice.api.servicereport.get_user_service_reports",auto:!1}),searchQuery:"",statusFilter:"",startDate:"",endDate:"",sortField:"",sortOrder:"asc"}),actions:{fetchAll(t){return this.currentPage=t,this.documentsResource.fetch({page:this.currentPage,page_size:this.pageSize,search:this.searchQuery,status:this.statusFilter,start_date:this.startDate,end_date:this.endDate,sort_field:this.sortField,sort_order:this.sortOrder}),this.documentsResource},setSearchQuery(t){this.searchQuery=t,this.fetchAll(1)},setStatusFilter(t){this.statusFilter=t,this.fetchAll(1)},setDateRange(t,m){this.startDate=t,this.endDate=m,this.fetchAll(1)},setSorting(t){this.sortField===t?this.sortOrder=this.sortOrder==="asc"?"desc":"asc":(this.sortField=t,this.sortOrder="asc"),this.fetchAll(this.currentPage)},nextPage(){this.currentPage<this.totalPages&&this.fetchAll(this.currentPage+1)},previousPage(){this.currentPage>1&&this.fetchAll(this.currentPage-1)},goToPage(t){t>=1&&t<=this.totalPages&&this.fetchAll(t)},get(t){return this.data.find(m=>m.id===t)}},getters:{data(){var t;return((t=this.documentsResource.data)==null?void 0:t.data)||[]},isFirstPage(){return this.currentPage===1},isLastPage(){return this.currentPage===this.totalPages},totalPages(){var t;return((t=this.documentsResource.data)==null?void 0:t.total_pages)||1}}}),B={class:"hidden md:block"},T={class:"table table-zebra w-full"},z={key:0,class:"ml-1"},E={key:0,class:"ml-1"},Q={key:0,class:"ml-1"},V={key:0},L={colspan:"4"},q={key:1},I=["onClick"],U={class:"text-xs text-gray-500"},J=["onClick"],G={key:2},H={colspan:"4"},K={class:"md:hidden"},M={key:0},W={key:1,class:"space-y-4"},X={class:"card-body"},Y=["onClick"],Z={class:"text-sm text-gray-500"},tt={class:"card-actions justify-end"},et={class:"flex justify-between items-center w-full"},st=["onClick"],rt={key:2},at=P({__name:"ServiceReportTable",props:{data:{type:Array,required:!0},loading:{type:Boolean,default:!1},error:{type:Boolean,default:!1},sortField:{type:String,default:""},sortOrder:{type:String,default:"asc"},sortable:{type:Boolean,default:!0}},emits:["sort"],setup(t,{emit:m}){const i=t,b=C("formatDate");D();const y=l=>{switch(l.toLowerCase()){case"customer review":return"badge badge-warning";case"customer approve":return"badge badge-success";case"rejected":return"badge badge-error";default:return"badge"}},h=O(()=>!i.sortable||!i.sortField?i.data:[...i.data].sort((l,s)=>l[i.sortField]<s[i.sortField]?i.sortOrder==="asc"?-1:1:l[i.sortField]>s[i.sortField]?i.sortOrder==="asc"?1:-1:0)),k=l=>{location.href=`/app/smo-service-report/${l}`},v=l=>{window.open(`/app/smo-expense-entry/new?service_report=${l}`,"_blank")};return(l,s)=>(a(),o("div",null,[e("div",B,[e("table",T,[e("thead",null,[e("tr",null,[e("th",{class:"cursor-pointer",onClick:s[0]||(s[0]=r=>l.$emit("sort","name"))},[s[3]||(s[3]=c(" No. ")),t.sortable?(a(),o("span",z,[e("span",{class:d({"text-primary":t.sortField==="name"})},n(t.sortField==="name"&&t.sortOrder==="asc"?"▲":"△"),3),e("span",{class:d({"text-primary":t.sortField==="name"})},n(t.sortField==="name"&&t.sortOrder==="desc"?"▼":"▽"),3)])):g("",!0)]),e("th",{class:"cursor-pointer",onClick:s[1]||(s[1]=r=>l.$emit("sort","job_start_on"))},[s[4]||(s[4]=c(" Date ")),t.sortable?(a(),o("span",E,[e("span",{class:d({"text-primary":t.sortField==="job_start_on"})},n(t.sortField==="job_start_on"&&t.sortOrder==="asc"?"▲":"△"),3),e("span",{class:d({"text-primary":t.sortField==="job_start_on"})},n(t.sortField==="job_start_on"&&t.sortOrder==="desc"?"▼":"▽"),3)])):g("",!0)]),e("th",{class:"cursor-pointer",onClick:s[2]||(s[2]=r=>l.$emit("sort","workflow_state"))},[s[5]||(s[5]=c(" Status ")),t.sortable?(a(),o("span",Q,[e("span",{class:d({"text-primary":t.sortField==="workflow_state"})},n(t.sortField==="workflow_state"&&t.sortOrder==="asc"?"▲":"△"),3),e("span",{class:d({"text-primary":t.sortField==="workflow_state"})},n(t.sortField==="workflow_state"&&t.sortOrder==="desc"?"▼":"▽"),3)])):g("",!0)]),s[6]||(s[6]=e("th",null,"Responsible",-1))])]),t.loading?(a(),o("tbody",V,[e("tr",null,[e("td",L,[u($)])])])):h.value.length>0?(a(),o("tbody",q,[(a(!0),o(p,null,F(h.value,r=>(a(),o("tr",{key:r.name},[e("td",null,[e("div",{class:"cursor-pointer",onClick:f=>k(r.name)},[c(n(r.name)+" ",1),s[7]||(s[7]=e("br",null,null,-1)),e("span",U,n(r.task_name),1)],8,I)]),e("td",null,n(w(b)(r.job_start_on)),1),e("td",null,[e("div",{class:d(y(r.workflow_state))},n(r.workflow_state),3),s[8]||(s[8]=e("br",null,null,-1)),e("button",{class:"btn btn-neutral btn-xs mt-1",onClick:f=>v(r.name)}," + Expense ",8,J)]),e("td",null,[u(_,{email:r.teams},null,8,["email"])])]))),128))])):(a(),o("tbody",G,[e("tr",null,[e("td",H,[u(j)])])]))])]),e("div",K,[t.loading?(a(),o("div",M,[u(A)])):h.value.length>0?(a(),o("div",W,[(a(!0),o(p,null,F(h.value,r=>(a(),o("div",{key:r.name,class:"card bg-base-100 shadow-xl"},[e("div",X,[e("h2",{class:"card-title cursor-pointer",onClick:f=>k(r.name)},n(r.name),9,Y),e("p",Z,n(r.task_name),1),e("p",null,"Date: "+n(w(b)(r.job_start_on)),1),e("p",null,[s[9]||(s[9]=c("Status: ")),e("span",{class:d(y(r.workflow_state))},n(r.workflow_state),3)]),e("div",tt,[e("div",et,[e("button",{class:"btn btn-neutral btn-sm",onClick:f=>v(r.name)},s[10]||(s[10]=[e("span",{class:"ml-1 text-xs"},"+ Expense",-1)]),8,st),u(_,{email:r.teams},null,8,["email"])])])])]))),128))])):(a(),o("div",rt,[u(N)]))])]))}}),ut=R(at,[["__scopeId","data-v-ca158248"]]);export{ut as S,dt as u};
