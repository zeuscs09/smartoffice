import{d as S,o as l,c as d,a as e,t as i,b as p,K as O,u as q,L as j,q as D,g as z,v as F,x as M,B as s,I as _,l as R,y as o,F as U,i as A}from"./index-by_FZnAW.js";import{u as E}from"./userLayout-CjBaU0cO.js";import{U as H}from"./UserAvatar-X8AlCWQw.js";const K={key:0,class:"flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0"},P={class:"text-gray-600 font-medium"},G={class:"text-gray-800"},n=S({__name:"InfoItem",props:{label:{},value:{}},setup(I){return(u,g)=>u.value?(l(),d("div",K,[e("span",P,i(u.label)+":",1),e("span",G,i(u.value),1)])):p("",!0)}}),J={key:0,class:"max-w-4xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden"},Q={key:0},W={class:"bg-gray-100 p-4 flex justify-between items-center"},X={class:"flex items-center space-x-4"},Y={class:"text-2xl font-bold text-gray-800"},Z={key:0},ee={class:"flex items-center space-x-4"},te={class:"p-6"},se={class:"grid md:grid-cols-2 gap-6"},ae={class:"space-y-4"},oe={class:"space-y-4"},le={class:"mt-8"},ne={key:0,class:"text-gray-600"},de={class:"mt-8"},re={key:0,class:"grid md:grid-cols-2 gap-4"},ce={class:"font-medium text-gray-800"},ie={class:"text-sm text-gray-500"},ue={key:1,class:"text-gray-600"},me={key:1,class:"flex flex-col justify-center items-center min-h-screen space-y-6"},pe={key:1,class:"text-center py-8"},be=S({__name:"TaskDetail",setup(I){const u=O(),g=q(),L=u.params.id,v=u.query.todo,a=j({doctype:"SMO Task",name:L,auto:!0}),r=j({doctype:"ToDo",name:v,auto:!0}),b=D(()=>a.loading||v&&r.loading),N=D(()=>{var c;return((c=r.doc)==null?void 0:c.status)==="Open"&&v&&!r.loading}),x=c=>c?new Date(c).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):"",y=()=>{g.go(-1)},T=()=>{a.doc.name&&v&&(location.href=`/app/smo-service-report/new?from_todo=${v}&from_page=${u.fullPath}&task=${a.doc.name}&from=frontend`)},V=c=>{const t="badge text-xs font-semibold px-2 py-1";switch(c){case"Open":return`${t} badge-primary`;case"Closed":return`${t} badge-success`;case"Cancelled":return`${t} badge-error`;default:return`${t} badge-ghost`}};return z(()=>{}),(c,t)=>(l(),F(E,null,{default:M(()=>{var f,h,k,C,w,$,B;return[b.value?p("",!0):(l(),d("div",J,[s(a).doc?(l(),d("div",Q,[e("div",W,[e("div",X,[e("h1",Y,[_(i(s(a).doc.task_name)+" ",1),(h=(f=s(r))==null?void 0:f.doc)!=null&&h.status?(l(),d("span",Z,[e("span",{class:R([V((C=(k=s(r))==null?void 0:k.doc)==null?void 0:C.status),"ml-2"])},i(((w=s(r).doc)==null?void 0:w.status)||"กำลังโหลด..."),3)])):p("",!0)])]),e("div",ee,[N.value?(l(),d("button",{key:0,onClick:T,class:"btn btn-ghost btn-sm"},t[0]||(t[0]=[e("span",null,"➕",-1),_(" New Service Report ")]))):p("",!0),e("button",{onClick:y,class:"btn btn-ghost btn-sm"},t[1]||(t[1]=[e("span",{class:"mr-2"},"←",-1),_(" Back ")]))])]),e("div",te,[e("div",se,[e("div",ae,[t[2]||(t[2]=e("h2",{class:"text-xl font-semibold text-gray-700 mb-3"},"ข้อมูลงาน",-1)),o(n,{label:"ประเภทงาน",value:s(a).doc.job_type},null,8,["value"]),o(n,{label:"สถานะ",value:s(r)?(B=($=s(r))==null?void 0:$.doc)==null?void 0:B.status:""},null,8,["value"]),o(n,{label:"ความสำคัญ",value:s(a).doc.priority},null,8,["value"]),o(n,{label:"ช่วงเวลา",value:s(a).doc.period},null,8,["value"]),o(n,{label:"วันที่เริ่ม",value:x(s(a).doc.start_date)},null,8,["value"]),o(n,{label:"วันที่สิ้นสุด",value:x(s(a).doc.finish_date)},null,8,["value"])]),e("div",oe,[t[3]||(t[3]=e("h2",{class:"text-xl font-semibold text-gray-700 mb-3"},"ข้อมูลโครงการ",-1)),o(n,{label:"โครงการ",value:s(a).doc.project_name},null,8,["value"]),o(n,{label:"ลูกค้า",value:s(a).doc.customer_name},null,8,["value"]),o(n,{label:"ผู้ติดต่อ",value:s(a).doc.contact_name},null,8,["value"]),o(n,{label:"เบอร์โทรผู้ติดต่อ",value:s(a).doc.contact_mobile},null,8,["value"]),o(n,{label:"อีเมลผู้ติดต่อ",value:s(a).doc.contact_email},null,8,["value"]),o(n,{label:"สถานที่",value:s(a).doc.site},null,8,["value"])])]),e("div",le,[t[4]||(t[4]=e("h2",{class:"text-xl font-semibold text-gray-700 mb-3"},"รายละเอียด",-1)),s(a).doc.detail?(l(),d("div",ne,i(s(a).doc.detail),1)):p("",!0)]),e("div",de,[t[5]||(t[5]=e("h2",{class:"text-xl font-semibold text-gray-700 mb-3"},"ทีมงาน",-1)),s(a).doc.team&&s(a).doc.team.length>0?(l(),d("div",re,[(l(!0),d(U,null,A(s(a).doc.team,m=>(l(),d("div",{key:m.name,class:"flex items-center space-x-4 bg-gray-50 p-4 rounded-lg"},[o(H,{email:m.email,size:"lg"},null,8,["email"]),e("div",null,[e("div",ce,i(m.full_name),1),e("div",ie,i(m.email),1),e("div",{class:R(["text-sm",m.overlapping_job_on_date?"text-red-500":"text-green-500"])},i(m.overlapping_job_on_date?"มีงานซ้อน":"ไม่มีงานซ้อน"),3)])]))),128))])):(l(),d("p",ue,"ไม่มีข้อมูลทีมงาน"))])])])):(l(),d("div",me,[t[7]||(t[7]=e("div",{class:"text-center"},[e("h2",{class:"text-2xl font-bold text-gray-800 mb-2"},"ไม่พบข้อมูล"),e("p",{class:"text-gray-600"},"ขออภัย ไม่พบข้อมูลงานที่คุณกำลังค้นหา")],-1)),e("button",{onClick:y,class:"btn btn-primary btn-sm"},t[6]||(t[6]=[e("span",{class:"mr-2"},"←",-1),_(" ย้อนกลับ ")]))]))])),b.value?(l(),d("div",pe,t[8]||(t[8]=[e("span",{class:"loading loading-spinner loading-lg"},null,-1)]))):p("",!0)]}),_:1}))}});export{be as default};
